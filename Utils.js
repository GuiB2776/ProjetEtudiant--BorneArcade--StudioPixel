///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////
document.addEventListener("keydown",fKeyDown,false);
document.addEventListener("keyup",fKeyUp,false);
///////////////////////////////////////////////////////////////////////////////////////////
var joystick=0;
///////////////////////////////////////////////////////////////////////////////////////////
function fKeyDown(event) {
	//alert(event.keyCode);
	switch(event.keyCode) {
		case 37:	// left
			joystick|=8;
			break;
		case 38:	// up
			joystick|=1;
			break;
		case 39:	// right
			joystick|=2;
			break;
		case 40:	// down
			joystick|=4;
			break;
		case 77:	// m
			joystick|=16;
			break;
		default:
			return;
	}
	event.preventDefault();
	event.stopPropagation();
}
///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////
function fKeyUp(event) {
	switch(event.keyCode) {
		case 37:	// left
			joystick&=0xffff-8;
			break;
		case 38:	// up
			joystick&=0xffff-1;
			break;
		case 39:	// right
			joystick&=0xffff-2;
			break;
		case 40:	// down
			joystick&=0xffff-4;
			break;
		case 77:	// m
			joystick&=0xffff-16;
			break;
		default:
			return;
	}
	event.preventDefault();
	event.stopPropagation();
}
///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////
function loadImage(list, endLoad) 
{

	var imgLoad = new Array();
	imgLoad.isReady = false;
	imgLoad.remainsToLoad = list.length;
    for (var i = 0; i < list.length; i++) 
    {
		imgLoad[i] = new Image();
		imgLoad[i].isReady = false;
		imgLoad[i].parent = imgLoad;
		//imgLoad[i].crossOrigin = 'file://';
		imgLoad[i].onload = function () 
		{
			this.onload = null;
			this.isReady = true;
			this.parent.remainsToLoad--;
			if (this.parent.remainsToLoad == 0) 
			{
				this.parent.isReady = true;
				if(typeof endLoad !== 'undefined') endLoad();
			}
		};
		imgLoad[i].src = list[i];
	}
	return imgLoad;
}
///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////
